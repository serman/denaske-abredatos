/**
 * Copyright (C) 2010 by Drupella.com - info at drupella dot com - http://drupella.com
 * Usage and redistribution of this javasript code requires permission from Drupella.com.
 */
;var ajaxGMBuild=function(b,a,c){b.extend(a,{initiate:function(){var e=c.settings.views.ajax_path,d;c.settings.views.ajax_path=typeof e=="string"?e:e[0];if(c.gmap){c.Views.Ajax.ajaxViewResponse=function(){}}},ajaxOptions:function(){return{type:"GET",url:c.settings.views.ajax_path,dataType:"json",success:a.ajaxSuccess,error:a.ajaxError}},ajaxSuccess:function(d){if(d.__callbacks){b.each(d.__callbacks,function(e,f){ajaxGMEval(f)("div.view-dom-id-"+d.dom_id,d)})}},ajaxError:function(d,e){alert(c.ahahError(d,e.url))},ajaxCallback:function(d,g){var d=b(d),e=null;for(var j in c.settings.gmap){if(d.find("div.gmap-"+j+"-gmap").size()){e=j;break}}if(!e){return}var i=c.gmap.getMap(e);if(i){var f=i.vars;var h=g.mapset[e]||{markers:[]};b.each(["zoom","latitude","longitude"],function(k,l){if(h[l]!==undefined&&f[l]!=h[l]){f[l]=h[l]*1;i.change(l,-1)}});b.each(f.markers,function(l,k){i.change("delmarker",-1,k)});i.change("clearmarkers",-1);f.markers=h.markers;i.change("iconsready",-1);i.change("markersready",-1)}a.pagerUpdate(d,g);a.messageUpdate(d,g)},pagerUpdate:function(d,e){b(d).find("ul.pager").html(b(e.display).find("ul.pager").html()||"").find("a").click(a.pagerClick)},messageUpdate:function(d,e){b(d).find(".views-messages").remove().end().prepend(e.messages)},pagerClick:function(f){b(this).addClass("views-throbbing");var d=a.ajaxOptions();d.url+=this.href.substr(this.href.indexOf("?"));d.complete=function(e){b(this).removeClass("views-throbbing")};b.ajax(d);return false}})};var ajaxGMEval=function(a){return eval(a)};
